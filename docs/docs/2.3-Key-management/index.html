<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">

	<title>Key management advice - Themis 0.9</title>

        <link href="../css/bootstrap-3.0.3.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">
        <link href="../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="..">Themis 0.9</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="..">Introduction</a>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">How to use <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../2.-How-to-use-Themis/">Intro</a>
                        </li>
                    
                        <li >
                            <a href="../2.1-Building-and-installing/">Building and installing</a>
                        </li>
                    
                        <li >
                            <a href="../2.2-Objects-reference/">Objects reference</a>
                        </li>
                    
                        <li class="active">
                            <a href="./">Key management advice</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Language reference <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../2.4-Language-reference/">Intro</a>
                        </li>
                    
                        <li >
                            <a href="../2.4.1-Python-Howto/">Python</a>
                        </li>
                    
                        <li >
                            <a href="../2.4.2-PHP-Howto/">PHP</a>
                        </li>
                    
                        <li >
                            <a href="../2.4.3-Ruby-Howto/">Ruby</a>
                        </li>
                    
                        <li >
                            <a href="../2.4.4-Objective-C-Howto/">Objective C</a>
                        </li>
                    
                        <li >
                            <a href="../2.4.5-Java---Android/">Java/Android</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li >
                    <a href="../3.-FAQ/">FAQ</a>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Fundamentals <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../4.1-General-design-principles/">General design principles</a>
                        </li>
                    
                        <li >
                            <a href="../4.2-Architecture/">Architecture</a>
                        </li>
                    
                        <li >
                            <a href="../4.3-Soter-cryptostack/">Soter cryptostack</a>
                        </li>
                    
                        <li >
                            <a href="../4.4-Cryptosystems/">Cryptosystems</a>
                        </li>
                    
                        <li >
                            <a href="../4.4.1-Secure-message/">Secure Message</a>
                        </li>
                    
                        <li >
                            <a href="../4.4.2-Secure-Session/">Secure Session</a>
                        </li>
                    
                        <li >
                            <a href="../4.4.3-Secure-Cell/">Secure Cell</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contributing <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../5.-Contributing-to-Themis/">Intro</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contributing  <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../5.1-Development-status/">Development roadmap</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contributing <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../5.2-Getting-started-with-development/">Getting started with development</a>
                        </li>
                    
                        <li >
                            <a href="../5.3-Directory-structure/">Directory structure</a>
                        </li>
                    
                        <li >
                            <a href="../5.4-Implementation-details/">Some implementation details</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
           <ul class="nav navbar-nav navbar-right">

                
                <li>
                    <a href="https://github.com/cossacklabs/themis/">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#key-management">Key management</a></li>
        
            <li><a href="#generating-keys">Generating keys</a></li>
        
            <li><a href="#storing-keys-in-your-application">Storing keys in your application</a></li>
        
            <li><a href="#signature-keys-vs-encryption-keys">Signature keys vs encryption keys</a></li>
        
            <li><a href="#exchanging-keys-and-transmitting-keys-over-the-network">Exchanging keys and transmitting keys over the network</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h2 id="key-management">Key management</h2>
<p>In current version of Themis, key management is left at consideration of end-user. However, we've got some advice and helpful tips for those willing to do truly secure development. Doing highest level of cryptography is negligible if your keys are not protected well. </p>
<h3 id="generating-keys">Generating keys</h3>
<p>A good key should be as random as possible. </p>
<p>Do not "contruct" keys yourself or use "secret strings" as keys directly. If possible, use strong random number generator to generate keys. If you really need to use a secret password, pass it through a key derivation function (one-way hash function which will make it look like a random key).</p>
<p>The idealistic way to generate long-term keys (any key which is used more than once is considered a long-term key) is to use a dedicated machine or device which is located in a separate room, not connected to the network (even private or corporate) and allows only authorized personell to administer it. Of course, there will be some simplifications in a way you will do it.</p>
<p>If possible, verify your random number generator with some statistical test suite (currently we use NIST STS to check RNGs we use). While passing statistical tests does not guarantee that you RNG is good, failing them surely proves it is bad and predictable.</p>
<p>You can use our key generation function (derived from OpenSSL) to generate your keys. </p>
<h3 id="storing-keys-in-your-application">Storing keys in your application</h3>
<p>Generally we recommend to use ephemeral (one-time) keys for encryption whenever possible and only use signature keys as long-term keys. Regardless of the key type, applications must not store the keys in plaintext (as is) on persistent storage. While using well defined policy and operating system access control mechanisms to limit access to key files is a good (and absolutely necessary thing) to do, storing them in encrypted form makes overall security level of your solution much higher. </p>
<p>The simplest way, which requires little effort and no infrastructure, you can go is to use some kind of a master password to encrypt all your keys in the application. Master password can be passed as some parameter on application startup and you can use <a href="../4.4.3-Secure-Cell/">secure cell</a> to protect all keys and other sensitive data.</p>
<h3 id="signature-keys-vs-encryption-keys">Signature keys vs encryption keys</h3>
<p>Do not use same asymmetric keys for signature and encryption (or key agreement). While mathematically they are same thing and you may be tempted to simplify your key management scheme, their purpose is what makes them different:</p>
<ul>
<li>
<p>Encryption (or key agreement) keys are used to protect data (or other keys). Loosing such key will definitely lead to loosing all data protected with this key. That's why most probably you would like to keep several copies of this key on different backup media. Also, access to this key may be granted to several people (for example, backup security officer needs to access the key when primary administrator is on unexpected sick leave). So, main aspects of this type of keys are: replicated, shared usage, critical not to loose.</p>
</li>
<li>
<p>Signature keys, on the other hand, are used to prove an identity (of a person or a computing node) in various authentication mechanisms. Loosing such key will not cause any data to be lost. These keys can be relatively easily replaced: you just have to notify all verifying parties that they should not trust the old key anymore and they should trust the new key instead. And, by carefully using timestamps, they can still trust the old data which was signed by the old key before such notification. But, since such key represents an identity, sharing or replicating it increases security risks, because each user of the key may impersonate this identity. That is why you would probably want to limit the number of potential users of signature keys as much as possible. For signature keys, which represent a person's identity there should be only one user - the person whose identity the key is representing. For machine keys we recommend not more than two people which are very trusted within their security domain. So, mostly, signature keys are: not replicable, single usage, affordable to loose, replacable.</p>
</li>
</ul>
<p>As you may see from above, contradicting use-cases and scenarios is what makes those keys different, so keep it in mind while designing your key hierarchy and key management scheme. Also, don't forget to store those keys in encrypted form regardless of key type.</p>
<h3 id="exchanging-keys-and-transmitting-keys-over-the-network">Exchanging keys and transmitting keys over the network</h3>
<p>The first recommendation may seem obvious: do not send the keys in plaintext over the network. Always encrypt them. But some usually forget about the second recommedation: even if you exchange public keys only, you should ensure their integrity and authentity, because if you do not - man-in-the-middle (MiTM) will take over all your communications. </p>
<p>Relying on integrity through encryption - is bad practice, so use a separate integrity mechanism. </p>
<p>Both <a href="../4.4.1-Secure-message/">secure message</a> and <a href="../4.4.2-Secure-Session/">secure session</a> ensure confidentiality, integrity and authentity of the transmitted data, so they can be used to send/receive keys as well.</p></div>
        </div>

	<footer class="col-md-12">
		<hr>
		
		<p>(c) 2015 Cossack Labs Limited</p>
		
		<p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
	</footer>


        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script>
        <script src="../js/base.js"></script>
    </body>
</html>